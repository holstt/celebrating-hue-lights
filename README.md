# celebrating-hue-lights

Celebrate the goal of your favorite team with your Philips Hue lights blinking in the team color!

## Features

**Team-Colored Light Alerts:** Your Philips Hue lights blink in the colors of your favorite team each time they score.
**Wide Range of Matches:** Follow any live match on [Flashscore](https://www.flashscore.com)
**Easy Hue Bridge setup:** A setup script is provided to easily create a new user on your Hue bridge.
**Custom Team Colors:** The application comes pre-loaded with team-to-color mappings for _countries_, but you can easily add your own.
**Sync Functionality:** Synchronize the alerts with your TV live stream by adding a custom delay to ensure you see the lights at the right moment.
**Room Selection:** Choose the room with the lights you want to blink.

# Setup

### 1. Install Dependencies

This project uses [Poetry](https://python-poetry.org/docs/) for dependency management.

Clone this repository and use Poetry to install the project's dependencies:

```
git clone https://github.com/username/repository.git
cd repository
poetry install
poetry shell
```

### 2. Create a user on your Hue bridge

To communicate with the Hue lights, you need to create a user on the Hue bridge. Follow the instructions provided in the `app_setup.py` script to take care of this business. This will also produce a configuration file to be used in the main script.

### 3. Configure the application

The configuration outputted by `app_setup.py` can be customized if the default settings don't match your preferences:

-   `blink_duration_seconds`: Length of the blink effect when a goal is scored.
-   `polling_interval_seconds`: How frequently the app checks Flashscore for updates.
-   `sync_delay_seconds`: Delays the light blinking. If your stream is behind the live score, this setting helps synchronize the goal alerts with your stream.

### Adding your own team-to-color mapping

To add your own team-to-color mapping, create a new JSON file in the `team_colors` directory following the format:

```json
{
    "team_name1": ["color1", "color2", ... ],
    "team_name2": ["color1",  ... ],
    ...
}
```

### 4. Run the Application

You can start the application with the following command:

```
poetry run python main.py -c <config_file> -m <match_url> -f <favorite_team>

```

-   `<config_file>`: (optional) The path to the configuration file generated by the `app_setup.py` script. If not provided, the application will assume the configuration file is located in project root.
-   `<match_url>`: The URL of the match you want to follow on [Flashscore](https://www.flashscore.com). Click on a **live match** on the page and copy the URL from the **popup** that appears. The URL should follow the format `https://www.flashscore.com/match/<match_id>/#match-summary/match-summary` (notice the extra match-summary at the end)
-   `<favorite_team>`: The name of your favorite team, which should be the exact name shown on the Flashscore match page as well as in the `team_colors` file.
